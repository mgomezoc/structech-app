{{!-- src/views/form/template.hbs --}}

<div class="form-view-container">
    <!-- Header -->
    <header class="alta-header">
        <button class="back-button" id="backBtn" aria-label="Regresar">
            <!-- You can replace this with an SVG icon -->
            ‚Üê
        </button>
        <h1 class="view-title">Registro de Persona</h1>
    </header>

    <!-- Progress Indicator -->
    <div class="progress-indicator">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <span class="progress-text" id="progressText">Completa todos los campos</span>
    </div>

    <!-- Form Container -->
    <div class="form-container">
        <form id="formPersona" class="alta-form" novalidate>

            <!-- Estructura Section -->
            <section id="estructuraSection" class="form-section">
                <div class="section-header">
                    <h2>Selecci√≥n de estructura</h2>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="estructura" class="required">
                            Estructura
                            
                        </label>
                        <div class="select-wrapper">
                            <select id="estructura" name="estructura" class="form-control" required>
                                <option value="">Sin selecci√≥n</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="subestructura" class="required">
                            Subestructura
                            
                        </label>
                        <div class="select-wrapper">
                            <select id="subestructura" name="subestructura" class="form-control" required disabled>
                                <option value="">Sin selecci√≥n</option>
                            </select>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Photo Section -->
            <section class="form-section">
                <div class="section-header">
                    <h2>Foto de perfil</h2>
                    <div class="section-actions">
                        <button type="button" id="btnScan" class="scan-button">
                            <div id="scanIcon"></div>
                            <span>Escanear INE</span>
                        </button>
                    </div>
                </div>
                <div class="profile-section">
                    <div class="profile-photo" id="profilePhoto">
                        <div id="profilePlaceholder" class="profile-placeholder">
                        </div>
                        <img id="profileImage" src="" alt="Foto de perfil" style="display: none;" />
                    </div>
            
                    <!-- Estado despu√©s del escaneo -->
                    <div class="scan-status" id="scanStatus" style="display: none;">
                        <div class="status-icon">‚úÖ</div>
                        <span>INE escaneado correctamente</span>
                    </div>
                </div>
            </section>

            <!-- Datos Personales Section -->
            <section class="form-section">
                <div class="section-header">
                    <h2>Datos personales</h2>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="nombre" class="required">Nombre</label>
                        <input type="text" id="nombre" name="nombre" class="form-control" placeholder="Nombre(s)"
                            required />
                    </div>
                    <div class="form-group">
                        <label for="apellidoPaterno" class="required">Apellido Paterno</label>
                        <input type="text" id="apellidoPaterno" name="apellidoPaterno" class="form-control"
                            placeholder="Apellido Paterno" required />
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="apellidoMaterno" class="required">Apellido Materno</label>
                        <input type="text" id="apellidoMaterno" name="apellidoMaterno" class="form-control"
                            placeholder="Apellido Materno" required />
                    </div>
                    <div class="form-group">
                        <label for="fechaNacimiento" class="required">Fecha de Nacimiento</label>
                        <input type="date" id="fechaNacimiento" name="fechaNacimiento" class="form-control" required />
                    </div>
                </div>
                <div class="form-group">
                    <label class="required">G√©nero</label>
                    <div class="gender-group">
                        <div class="gender-option">
                            <input type="radio" id="hombre" name="genero" value="M" required />
                            <label for="hombre">üë® Hombre</label>
                        </div>
                        <div class="gender-option">
                            <input type="radio" id="mujer" name="genero" value="F" />
                            <label for="mujer">üë© Mujer</label>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Identificaci√≥n Section -->
            <section class="form-section">
                <div class="section-header">
                    <h2>Identificaci√≥n</h2>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="curp" class="required">CURP</label>
                        <input type="text" id="curp" name="curp" class="form-control" maxlength="18" placeholder="CURP" required />
                    </div>
                    <div class="form-group">
                        <label for="claveElector" class="required">Clave de Elector</label>
                        <input type="text" id="claveElector" name="claveElector" class="form-control" placeholder="Clave de Elector" required />
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="domicilio" class="required">Domicilio</label>
                        <input type="text" id="domicilio" name="domicilio" class="form-control" placeholder="Domicilio completo" required />
                    </div>
                    <div class="form-group">
                        <label for="seccion" class="required">Secci√≥n</label>
                        <input type="text" inputmode="numeric" pattern="\d{4}" maxlength="4" id="seccion" name="seccion" class="form-control"
                            placeholder="Secci√≥n electoral" required />

                    </div>
                </div>
            </section>

            <!-- Observaciones y Contacto Section -->
            <section class="form-section">
                <div class="section-header">
                    <h2>Observaciones y contacto</h2>
                </div>
                <div class="form-group">
                    <label for="observacion">Observaci√≥n</label>
                    <textarea id="observacion" name="observacion" class="form-control" rows="3"
                        placeholder="Agregar observaciones..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="telefono" class="required">Tel√©fono</label>
                        <input type="tel" id="telefono" name="telefono" class="form-control"
                            placeholder="N√∫mero de tel√©fono" required />
                    </div>
                    <div class="form-group">
                        <label for="email" class="required">Email</label>
                        <input type="email" id="email" name="email" class="form-control"
                            placeholder="Correo electr√≥nico" required />
                    </div>
                </div>
            </section>

            <!-- Preguntas Adicionales Section -->
            <section class="form-section" id="questionsSection" style="display: none;">
                <div class="section-header">
                    <h2>Informaci√≥n adicional</h2>
                    <span class="section-helper">Responde las siguientes preguntas</span>
                </div>
                <div id="dynamicQuestionsContainer"></div>
            </section>

            <!-- Firma Section -->
            <section class="form-section">
                <div class="section-header">
                    <h2>Firma de autorizaci√≥n</h2>
                    <span class="section-helper">Dibuja tu firma o escan√©ala desde tu INE</span>
                </div>
                <div class="signature-section">
                    <div class="signature-box" id="signatureBox">
                        <canvas id="signatureCanvas"></canvas>
                        <img id="signatureImage" alt="Firma escaneada" style="display: none;" />
                        <div id="signaturePlaceholder">‚úèÔ∏è</div>
                    </div>
                    <div class="signature-controls">
                        <button type="button" id="clearSignature">Limpiar Firma</button>
                        <button type="button" id="undoSignature">Deshacer</button>
                    </div>
                    <p class="signature-help">Mant√©n presionado para dibujar tu firma</p>
                </div>
            </section>

            <!-- Audio Section -->
            <section class="form-section">
                <div class="section-header">
                    <h2>Notas de voz</h2>
                </div>
                <div class="audio-section">
                    <div class="audio-controls">
                        <button type="button" id="audioBtn">üé§</button>
                        <div class="audio-info">
                            <div id="audioTimer">00:00:00</div>
                            <span id="audioHint">Mant√©n presionado para grabar</span>
                        </div>
                        <button type="button" id="audioDelete" class="audio-delete">üóëÔ∏è</button>
                    </div>
                    <div id="audioWave" class="audio-wave">
                        <span></span><span></span><span></span><span></span><span></span>
                    </div>
                </div>
            </section>

            <!-- Hidden Fields -->
            <input type="hidden" id="documentNumber" name="documentNumber" />
            <input type="hidden" id="fullDocumentFrontImage" name="fullDocumentFrontImage" />
            <input type="hidden" id="fullDocumentBackImage" name="fullDocumentBackImage" />
            <input type="hidden" id="faceImageData" name="faceImageData" />
            <input type="hidden" id="signatureImageData" name="signatureImageData" />
            <input type="hidden" id="idMex" name="idMex" />

            <!-- Submit Section -->
            <section class="form-actions">
                <button type="submit" class="btn-submit save-button">
                    <span class="btn-text">Guardar</span>
                    <div class="btn-loader hidden">
                        <div class="mini-spinner white"></div>
                    </div>
                </button>
            </section>
        </form>
    </div>
</div>